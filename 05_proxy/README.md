# 代理模式

代理模式，在不改变原始类（或叫被代理类）代码的情况下，通过引入代理类来给原始类附加功能。 

## 代理模式的应用场景

非常多。

### 1. 业务系统的非功能性需求开发

比如：监控、统计、鉴权、限流、事务、幂等、日志。将这些附加功能与业务解耦，放到代理类汇总统一处理，让程序员只需要关注业务方面的开发。

### 2. RPC、缓存中的应用

RPC框架也可以看作一种代理模式。通过远程代理，将网络通信、数据编解码等细节隐藏起来。RPC服务的开发者也只需要开发业务逻辑，就像开发本地使用的函数一样，不需要关注和客户端的交互细节。

对于缓存，当请求到达的时候，在AOP切面中拦截请求，如果请求中带有支持缓存的字段，便从缓存（内存缓存或者Redis缓存）中获取数据直接返回。

## 静态代理

### 1. 实现方式

代理类和原始类实现同一个接口，原始类只负责业务功能。代理类负责在业务代码执行前后附加其他逻辑代码，并通过委托的方式调用原始类来执行业务代码。

### 2. 静态代理的缺点

一方面，我们需要在代理类中，将原始类中的所有方法，都重新实现一遍，并且为每个方法都附加相似的代码逻辑。

另一方面，如果要添加的附加功能的类有不止一个，我们需要针对每个类都创建一个代理类。

如何解决？如果是java中，可以使用动态代理来解决。就是不事先为每个原始类编写代理类，而是在运行的时候，动态地创建原始类对应的代理类，然后在系统中用代理类替换掉原始类。如何实现动态代理呢？如果是java，动态代理的实现很简单，就是用反射语法。go中如何实现，待补充。
